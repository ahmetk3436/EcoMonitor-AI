{
  "tasks": [
    {
      "id": "enhance_001",
      "title": "Replace dummy satellite analysis with real AI-powered environmental analysis",
      "description": "The backend satellite_service.go GenerateDummyAnalysis() at line 25 generates 100% FAKE data using math/rand: random change types, random confidence scores (0.5-1.0), random dates, and a placeholder image URL 'https://example.com/satellite-image-placeholder.jpg'. This is the app's core feature and MUST use real AI.\n\nModify file: backend/internal/services/satellite_service.go\n- Add OPENAI_API_KEY to config/config.go: OpenAIAPIKey string, loaded from getEnv(\"OPENAI_API_KEY\", \"\")\n- Replace GenerateDummyAnalysis() with AnalyzeCoordinate(coordinateID uuid.UUID, userID uuid.UUID) that:\n  1. Fetches the coordinate from DB to get lat/lng/label\n  2. Builds a prompt: 'You are an environmental analysis AI. Analyze the area at latitude {lat}, longitude {lng} ({label}). Based on your knowledge of this geographic region, provide a realistic environmental change assessment. Return JSON array with objects containing: change_type (one of: construction, vegetation_loss, water_change, urban_expansion, deforestation, pollution, flooding, erosion), confidence (0.0-1.0), summary (2-3 sentence description of the specific change detected at this location), detected_at (ISO8601 date within last 30 days). Provide 1-4 realistic entries based on what environmental changes are plausible for this region.'\n  3. Calls OpenAI API: POST https://api.openai.com/v1/chat/completions with model 'gpt-4o-mini' (free tier) or 'gpt-4o' (premium - check subscription), temperature 0.7, max_tokens 1500\n  4. Parses the JSON response, validates each entry, creates SatelliteData records in DB\n  5. Sets ImageURL to empty string (remove placeholder URL entirely)\n- Add new import: 'net/http', 'encoding/json', 'bytes', 'io'\n- Add OpenAI request/response structs in the service file\n- Update SatelliteService struct to hold config: type SatelliteService struct { db *gorm.DB; cfg *config.Config }\n- Update NewSatelliteService signature: func NewSatelliteService(db *gorm.DB, cfg *config.Config) *SatelliteService\n- Update main.go line 46: satelliteService := services.NewSatelliteService(database.DB, cfg)\n- Update satellite_handler.go GenerateAnalysis to call AnalyzeCoordinate instead of GenerateDummyAnalysis, passing userID from JWT\n- If OPENAI_API_KEY is empty, return error response 'AI analysis service not configured' instead of generating fake data",
      "status": "completed",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-14T18:54:44Z"
    },
    {
      "id": "enhance_002",
      "title": "Add expanded change types and AI analysis summary to satellite data model",
      "description": "The current SatelliteData model at backend/internal/models/satellite_data.go only supports 4 change types (construction, vegetation_loss, water_change, urban_expansion). Expand for real environmental monitoring.\n\nModify file: backend/internal/models/satellite_data.go\n- Add Severity field: Severity string `gorm:\"type:varchar(20);default:'medium'\" json:\"severity\"` (values: low, medium, high, critical)\n- Add AIModel field: AIModel string `gorm:\"type:varchar(50)\" json:\"ai_model\"` to track which model generated the analysis\n- Remove the varchar(50) constraint on ChangeType, change to varchar(100) to support new types: deforestation, pollution, flooding, erosion, wildfire_risk, biodiversity_loss\n- Add Description field: Description string `gorm:\"type:text\" json:\"description\"` for detailed AI-generated analysis text (separate from Summary which is brief)\n\nModify file: backend/internal/dto/satellite_dto.go\n- Add Severity string to SatelliteDataResponse: Severity string `json:\"severity\"`\n- Add AIModel string to SatelliteDataResponse: AIModel string `json:\"ai_model\"`\n- Add Description string to SatelliteDataResponse: Description string `json:\"description\"`\n- Add Severity and Description to AlertResponse struct as well\n\nModify file: backend/internal/services/satellite_service.go\n- Update mapSatelliteToResponse to include Severity, AIModel, Description fields\n- Update GetLatestAlerts query to include satellite_data.severity and satellite_data.description in SELECT\n- Update AlertResponse mapping to include new fields\n\nModify file: mobile/types/satellite.ts\n- Add 'deforestation' | 'pollution' | 'flooding' | 'erosion' | 'wildfire_risk' | 'biodiversity_loss' to ChangeType union\n- Add severity: 'low' | 'medium' | 'high' | 'critical' to SatelliteAlert interface\n- Add description?: string to SatelliteAlert interface\n- Add aiModel?: string to SatelliteAlert interface",
      "status": "in_progress",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-14T18:54:44Z"
    },
    {
      "id": "enhance_003",
      "title": "Wire history recording into satellite analysis handler",
      "description": "The HistoryService exists but the SatelliteHandler.GenerateAnalysis at backend/internal/handlers/satellite_handler.go line 21 never calls historyService.RecordAnalysis(). Analysis results are generated but never recorded in history, making the history screen always empty unless manually populated.\n\nModify file: backend/internal/handlers/satellite_handler.go\n- Update SatelliteHandler struct to include historyService: type SatelliteHandler struct { satelliteService *services.SatelliteService; historyService *services.HistoryService }\n- Update NewSatelliteHandler: func NewSatelliteHandler(satelliteService *services.SatelliteService, historyService *services.HistoryService) *SatelliteHandler\n- In GenerateAnalysis method, after successful analysis generation (line 30-40), extract userID from JWT context using extractUserID(c), then call h.historyService.RecordAnalysis(userID, coordinateID, \"satellite\", results)\n- Log but don't fail if history recording fails (non-critical path): if err := h.historyService.RecordAnalysis(...); err != nil { log.Printf(\"Failed to record analysis history: %v\", err) }\n- Add 'log' to imports\n\nModify file: backend/cmd/server/main.go\n- Update line 55: satelliteHandler := handlers.NewSatelliteHandler(satelliteService, historyService)\n\nModify file: backend/internal/routes/routes.go\n- No changes needed, handler signature hasn't changed from routes perspective\n\nThis ensures every analysis run is automatically persisted to the history table, making the History tab on mobile actually show real data.",
      "status": "pending",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_004",
      "title": "Add CSV data export endpoint for premium users",
      "description": "Users need to export their environmental monitoring data. Add a CSV export endpoint gated behind subscription status.\n\nCreate file: backend/internal/services/export_service.go\n- type ExportService struct { db *gorm.DB }\n- func NewExportService(db *gorm.DB) *ExportService\n- func (s *ExportService) ExportUserDataCSV(userID uuid.UUID) ([]byte, error):\n  1. Query all coordinates for user with their satellite_data joined\n  2. Build CSV with headers: Location,Latitude,Longitude,Change Type,Confidence,Severity,Summary,Detected At\n  3. Use encoding/csv and bytes.Buffer to write CSV\n  4. Return buffer.Bytes()\n\nCreate file: backend/internal/handlers/export_handler.go\n- type ExportHandler struct { exportService *services.ExportService }\n- func NewExportHandler(exportService *services.ExportService) *ExportHandler\n- func (h *ExportHandler) ExportCSV(c *fiber.Ctx) error:\n  1. Extract userID from JWT\n  2. Call exportService.ExportUserDataCSV(userID)\n  3. Set headers: Content-Type: text/csv, Content-Disposition: attachment; filename=ecomonitor-export.csv\n  4. Return c.Send(csvBytes)\n\nModify file: backend/cmd/server/main.go\n- Add: exportService := services.NewExportService(database.DB)\n- Add: exportHandler := handlers.NewExportHandler(exportService)\n\nModify file: backend/internal/routes/routes.go\n- Add exportHandler parameter to Setup function\n- Add route: protected.Get(\"/export/csv\", exportHandler.ExportCSV)\n\nModify file: mobile/app/(protected)/settings.tsx\n- Add 'Export Data' row in the ACCOUNT section with icon 'download-outline'\n- OnPress: call api.get('/export/csv', { responseType: 'blob' }), then use Sharing.shareAsync from expo-sharing to share the file\n- Add import { shareAsync } from 'expo-sharing' (already in package.json via expo)",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_005",
      "title": "Redesign map screen with dark theme and NativeWind styling",
      "description": "The map screen at mobile/app/(protected)/map.tsx uses raw StyleSheet.create with white/light theme (#ddd borders, white backgrounds, #007AFF buttons) that completely breaks the app's dark theme. All other screens use bg-gray-950, #111827 cards, emerald accents. The map screen looks like a different app.\n\nModify file: mobile/app/(protected)/map.tsx\n- Replace the entire StyleSheet.create block (lines 244-355) with NativeWind className styling\n- Loading state: Replace plain ActivityIndicator with dark-themed skeleton matching other screens:\n  \u003cSafeAreaView className=\"flex-1 bg-gray-950\"\u003e\u003cView className=\"flex-1 items-center justify-center\"\u003e\u003cActivityIndicator size=\"large\" color=\"#10b981\" /\u003e\u003cText className=\"text-gray-400 mt-3\"\u003eLoading map...\u003c/Text\u003e\u003c/View\u003e\u003c/SafeAreaView\u003e\n- Map container: Keep StyleSheet only for map flex (RN Maps requires it), add dark mode: \u003cMapView userInterfaceStyle=\"dark\"\n- Marker info overlay (lines 164-188): Replace white background with dark theme:\n  className=\"absolute bottom-5 left-5 right-5 rounded-2xl p-4\" style={{ backgroundColor: '#111827', borderWidth: 1, borderColor: '#1f2937' }}\n  Label: className=\"text-lg font-bold text-white\"\n  Description: className=\"text-sm text-gray-400 mb-3\"\n  Delete button: className=\"flex-row items-center px-4 py-2 rounded-xl\" style={{ backgroundColor: 'rgba(239, 68, 68, 0.15)' }} with red text\n  Close button: use Ionicons color=\"#6b7280\"\n- BottomSheet: Add dark background: backgroundStyle={{ backgroundColor: '#111827' }}, handleIndicatorStyle={{ backgroundColor: '#374151' }}\n  Title: className=\"text-xl font-bold text-white text-center mb-5\"\n  Inputs: className=\"rounded-xl p-3 mb-4 text-white\" style={{ backgroundColor: '#1f2937', borderWidth: 1, borderColor: '#374151' }} with placeholderTextColor=\"#6b7280\"\n  Save button: Replace #007AFF with emerald gradient using LinearGradient colors={['#10b981', '#059669']}\n  Cancel button: style={{ backgroundColor: '#1f2937' }} with className=\"text-gray-400 font-semibold\" text\n- Add 'Analyze' button next to Delete in marker info: green button that calls api.post(`/coordinates/${selectedCoordinate.id}/analyze`) with hapticSuccess on completion\n- Add import { LinearGradient } from 'expo-linear-gradient' and { hapticLight, hapticError } from haptics\n- Add import { SafeAreaView } from 'react-native-safe-area-context'",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_006",
      "title": "Add error states with retry to home and history screens",
      "description": "Home screen (mobile/app/(protected)/home.tsx line 203) silently catches all errors with empty catch block. History screen (mobile/app/(protected)/history.tsx line 37) also silently handles errors. Both screens should show user-friendly error states with retry buttons matching the alerts screen pattern.\n\nModify file: mobile/app/(protected)/home.tsx\n- Add error state: const [error, setError] = useState\u003cstring | null\u003e(null)\n- In fetchData (line 195), wrap in try/catch that sets error message: catch (err: any) { setError(err.response?.data?.message || 'Failed to load dashboard data'); } and remove the inner .catch(() =\u003e ...) on individual promises\n- Add error UI between loading check and main return (after line 252), matching alerts screen pattern:\n  \u003cSafeAreaView className=\"flex-1 bg-gray-950\" edges={['top']}\u003e\n    \u003cView className=\"px-6 pt-6 pb-4\"\u003e\u003cText className=\"text-3xl font-bold text-white\"\u003eEcoMonitor AI\u003c/Text\u003e\u003c/View\u003e\n    \u003cView className=\"flex-1 justify-center items-center px-8\"\u003e\n      \u003cIonicons name=\"cloud-offline-outline\" size={64} color=\"#ef4444\" /\u003e\n      \u003cText className=\"text-lg font-semibold text-white mt-4\"\u003eConnection Error\u003c/Text\u003e\n      \u003cText className=\"text-sm text-gray-400 mt-2 text-center\"\u003e{error}\u003c/Text\u003e\n      \u003cPressable className=\"rounded-2xl px-8 py-3 mt-6\" style={{ backgroundColor: '#10b981' }} onPress={() =\u003e { setError(null); setLoading(true); fetchData(); }}\u003e\n        \u003cText className=\"text-white font-semibold\"\u003eRetry\u003c/Text\u003e\n      \u003c/Pressable\u003e\n    \u003c/View\u003e\n  \u003c/SafeAreaView\u003e\n- Add import { hapticError } from haptics, call hapticError() in the catch block\n\nModify file: mobile/app/(protected)/history.tsx\n- Add error state: const [error, setError] = useState\u003cstring | null\u003e(null)\n- In fetchHistory (line 26), add setError(null) at start and catch block: catch (err: any) { setError('Failed to load analysis history. Pull to refresh or try again.'); }\n- Add error UI between loading check and main return (after line 133):\n  Same pattern as home screen but with text 'Failed to load history' and icon 'time-outline' size 64 color '#ef4444'\n  Retry button calls: setError(null); setLoading(true); setPage(1); fetchHistory(1, true);\n- Import hapticError from haptics, call in catch block",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_007",
      "title": "Add alert detail screen with full analysis view and share card",
      "description": "Home screen alert cards have a 'Details' button (line 427) that does nothing (just hapticSelection with comment '// View details action'). There's no dedicated alert detail screen to show full analysis information.\n\nCreate file: mobile/app/(protected)/alert-detail.tsx\n- Export default function AlertDetailScreen()\n- Get alert data via route params: const { id, coordinateId, changeType, confidence, latitude, longitude, summary, detectedAt, severity, label } = useLocalSearchParams\u003c{...}\u003e()\n- Import from expo-router: useLocalSearchParams, useRouter\n- Import: SafeAreaView, View, Text, ScrollView, Pressable from react-native\n- Import: Ionicons from @expo/vector-icons, LinearGradient from expo-linear-gradient\n- Import: hapticLight, hapticSelection from lib/haptics, shareAlert from lib/share\n\nScreen layout:\n- SafeAreaView bg-gray-950 edges={['top']}\n- Header row: back button (Ionicons chevron-back, onPress router.back()) + title 'Alert Details' + share button (share-outline)\n- Hero card with LinearGradient based on change type color (use CHANGE_COLORS map):\n  - Large icon (size 48) for change type centered\n  - Change type label text-2xl font-bold text-white\n  - Confidence badge: rounded-full px-4 py-2, text showing '{confidence}% Confidence'\n- Info cards section (rounded-2xl bg-[#111827] border border-gray-800 p-4 mx-4 mb-3):\n  - Location card: Ionicons location-outline, label text, lat/lng coordinates text-gray-400\n  - Detection date card: Ionicons calendar-outline, formatted date\n  - Severity card: Ionicons warning-outline, severity badge with color coding (critical=red, high=orange, medium=yellow, low=green)\n- Summary section: mx-4 p-4 bg-[#111827] rounded-2xl, text-lg font-bold 'Analysis Summary', text-gray-300 showing full summary\n- Action buttons at bottom:\n  - 'Run New Analysis' green gradient button → calls api.post(`/coordinates/${coordinateId}/analyze`)\n  - 'Share Alert' outline button → calls shareAlert\n\nModify file: mobile/app/(protected)/home.tsx\n- Update 'Details' button onPress (line 428) to: router.push({ pathname: '/(protected)/alert-detail', params: { id: alert.id, coordinateId: alert.coordinate_id, changeType: alert.change_type, confidence: String(alert.confidence), latitude: String(alert.latitude), longitude: String(alert.longitude), summary: alert.summary, detectedAt: alert.detected_at, label: '' } })",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_008",
      "title": "Add expanded change type icons, colors, and severity badges across all screens",
      "description": "Currently only 4 change types have icons/colors defined in home.tsx (lines 47-59) and alerts.tsx (lines 22-34). With enhance_002 adding new types (deforestation, pollution, flooding, erosion, wildfire_risk, biodiversity_loss), all screens need updated icon/color maps plus severity badge rendering.\n\nModify file: mobile/app/(protected)/home.tsx\n- Expand CHANGE_ICONS (line 47): add deforestation: 'cut', pollution: 'cloud', flooding: 'rainy', erosion: 'trending-down', wildfire_risk: 'flame', biodiversity_loss: 'bug'\n- Expand CHANGE_COLORS (line 54): add deforestation: '#b45309', pollution: '#6b7280', flooding: '#0ea5e9', erosion: '#a16207', wildfire_risk: '#dc2626', biodiversity_loss: '#15803d'\n- In alert cards (line 360-436), add severity badge after the confidence badge:\n  {alert.severity \u0026\u0026 \u003cView className=\"px-2 py-0.5 rounded-full ml-2\" style={{ backgroundColor: `${getSeverityColor(alert.severity)}20` }}\u003e\u003cText style={{ color: getSeverityColor(alert.severity) }} className=\"text-xs font-bold\"\u003e{alert.severity.toUpperCase()}\u003c/Text\u003e\u003c/View\u003e}\n- Add helper: const getSeverityColor = (s: string) =\u003e ({ critical: '#ef4444', high: '#f97316', medium: '#eab308', low: '#22c55e' }[s] || '#6b7280')\n\nModify file: mobile/app/(protected)/alerts.tsx\n- Expand CHANGE_ICONS (line 22): same additions as home.tsx\n- Expand CHANGE_BORDER_COLORS (line 29): same color additions as home.tsx\n- In renderAlertItem, add severity badge next to confidence percentage\n- Add getSeverityColor helper function\n\nModify file: mobile/types/satellite.ts\n- Update AlertItem interface used in home.tsx to include optional severity field: severity?: string\n\nThis ensures consistent visual language across all screens for the expanded environmental monitoring categories.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_009",
      "title": "Implement real biometric app lock with SecureStore persistence",
      "description": "Settings screen (mobile/app/(protected)/settings.tsx lines 73-74, 262-285) has a biometric toggle UI that only updates local useState. The toggle doesn't persist across app restarts and doesn't actually lock the app. The biometrics.ts lib exists but is only checked for availability, never used for authentication.\n\nModify file: mobile/lib/biometrics.ts\n- Add BIOMETRIC_ENABLED_KEY constant: 'eco_biometric_enabled'\n- Add function setBiometricLock(enabled: boolean): stores to SecureStore\n- Add function isBiometricLockEnabled(): reads from SecureStore, returns boolean\n- Add function authenticateWithBiometrics(): calls LocalAuthentication.authenticateAsync with promptMessage 'Unlock EcoMonitor AI', returns boolean\n\nModify file: mobile/app/(protected)/settings.tsx\n- Import { setBiometricLock, isBiometricLockEnabled } from '../../lib/biometrics'\n- In useEffect checkBiometrics (line 84): also load persisted biometric state: const enabled = await isBiometricLockEnabled(); setBiometricEnabled(enabled);\n- In Switch onValueChange (line 276): call setBiometricLock(val) after setBiometricEnabled(val)\n\nModify file: mobile/app/(protected)/_layout.tsx\n- Add biometric gate: on mount, check isBiometricLockEnabled(). If true, show a full-screen lock overlay (bg-gray-950 with Ionicons lock-closed size 64 color emerald-500 and 'Unlock with {biometricType}' text)\n- Call authenticateWithBiometrics() automatically on mount. If fails, show 'Try Again' button\n- Only render children (Slot) after successful authentication or if biometric lock is disabled\n- State: const [isUnlocked, setIsUnlocked] = useState(false); const [biometricRequired, setBiometricRequired] = useState(false)\n- On mount: const required = await isBiometricLockEnabled(); setBiometricRequired(required); if (!required) setIsUnlocked(true); else { const success = await authenticateWithBiometrics(); setIsUnlocked(success); }\n- Import { authenticateWithBiometrics, isBiometricLockEnabled } from '../../lib/biometrics'",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_010",
      "title": "Add contextual paywall trigger after successful analysis completion",
      "description": "The app shows paywall only when non-subscribed users click 'Analyze' in alerts.tsx (line 92-95). According to 2025-2026 UX trends, contextual paywalls should appear at 'win moments' — after the user has already received value. Currently after analysis success, an Alert.alert shows 'Share your findings?' which is a missed conversion opportunity.\n\nModify file: mobile/app/(protected)/alerts.tsx\n- Replace the post-analysis Alert.alert (lines 105-112) with a contextual paywall prompt for non-subscribed users:\n  After hapticSuccess() and await fetchAlerts(), check if (!isSubscribed \u0026\u0026 !isGuest):\n    Show a richer Alert.alert with title 'Analysis Complete!' and message 'You found {results.length} environmental changes! Upgrade to Pro for unlimited analyses, CSV exports, and priority alerts.'\n    Buttons: [{ text: 'Upgrade Now', onPress: () =\u003e router.push('/(protected)/paywall' as any) }, { text: 'Share Results', onPress: () =\u003e shareAnalysisSummary(...) }, { text: 'Later', style: 'cancel' }]\n  For subscribed users or guests, keep the existing share prompt\n\nModify file: mobile/app/(protected)/home.tsx\n- Add a 'Pro Tip' banner below the streak card for non-subscribed users (between lines 304-306):\n  {!isSubscribed \u0026\u0026 !isGuest \u0026\u0026 (\n    \u003cPressable className=\"mx-4 mb-4 rounded-2xl p-4 overflow-hidden\" onPress={() =\u003e { hapticLight(); router.push('/(protected)/paywall' as any); }}\u003e\n      \u003cLinearGradient colors={['#8b5cf6', '#7c3aed']} start={{x:0,y:0}} end={{x:1,y:0}} className=\"absolute inset-0\" /\u003e\n      \u003cView className=\"flex-row items-center\"\u003e\n        \u003cIonicons name=\"diamond\" size={24} color=\"#ffffff\" /\u003e\n        \u003cView className=\"ml-3 flex-1\"\u003e\n          \u003cText className=\"text-white font-bold\"\u003eUnlock Pro Features\u003c/Text\u003e\n          \u003cText className=\"text-white/70 text-xs mt-0.5\"\u003eUnlimited analyses, exports \u0026 priority alerts\u003c/Text\u003e\n        \u003c/View\u003e\n        \u003cIonicons name=\"chevron-forward\" size={20} color=\"#ffffff80\" /\u003e\n      \u003c/View\u003e\n    \u003c/Pressable\u003e\n  )}\n- Import useSubscription from contexts/SubscriptionContext\n- Destructure: const { isSubscribed } = useSubscription()",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_011",
      "title": "Add environmental impact score calculation to home dashboard",
      "description": "The home screen shows basic stats (locations count, alerts count, critical count) but has no meaningful computed metric. Add an 'Environmental Impact Score' that gives users a sense of their monitoring contribution. This replaces the potential for fake/random scoring with a real calculated metric.\n\nModify file: mobile/app/(protected)/home.tsx\n- Add state: const [impactScore, setImpactScore] = useState(0)\n- Calculate impact score in fetchData after getting alerts and coordinates:\n  const locationPoints = coordsRes.data?.coordinates?.length * 10 || 0\n  const alertPoints = alertsRes.data?.alerts?.length * 5 || 0\n  const criticalBonus = (alertsRes.data?.alerts?.filter((a: AlertItem) =\u003e a.confidence \u003e 0.8)?.length || 0) * 15\n  const streakBonus = streakData.currentStreak * 2\n  const score = Math.min(100, locationPoints + alertPoints + criticalBonus + streakBonus)\n  setImpactScore(score)\n- Add Impact Score card ABOVE the stats row (before line 307), after streak card:\n  \u003cView className=\"mx-4 mb-4 rounded-2xl p-4 border-2 border-gray-800\" style={{ backgroundColor: '#111827' }}\u003e\n    \u003cView className=\"flex-row items-center justify-between mb-2\"\u003e\n      \u003cText className=\"text-base font-bold text-white\"\u003eImpact Score\u003c/Text\u003e\n      \u003cView className=\"flex-row items-center\"\u003e\n        \u003cIonicons name=\"trophy\" size={16} color=\"#fbbf24\" /\u003e\n        \u003cText className=\"text-2xl font-bold text-white ml-1\"\u003e{impactScore}\u003c/Text\u003e\n        \u003cText className=\"text-gray-400 text-sm\"\u003e/100\u003c/Text\u003e\n      \u003c/View\u003e\n    \u003c/View\u003e\n    \u003cView className=\"h-2 rounded-full bg-gray-800 overflow-hidden\"\u003e\n      \u003cView className=\"h-full rounded-full\" style={{ width: `${impactScore}%`, backgroundColor: impactScore \u003e 75 ? '#10b981' : impactScore \u003e 40 ? '#f59e0b' : '#ef4444' }} /\u003e\n    \u003c/View\u003e\n    \u003cText className=\"text-xs text-gray-500 mt-2\"\u003eMonitor more locations and maintain your streak to increase your score\u003c/Text\u003e\n  \u003c/View\u003e\n- Move the score calculation to AFTER recordDailyCheck resolves, so streak bonus is included\n- This gives users a gamified reason to return daily and add more monitoring locations",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_012",
      "title": "Add admin middleware role check and fix security gap in moderation routes",
      "description": "The routes.go file (line 67) has a comment noting the admin moderation panel needs proper admin middleware. Currently middleware.AdminRequired exists but needs verification. The backend needs a proper role-based access control.\n\nModify file: backend/internal/models/user.go\n- Add Role field: Role string `gorm:\"type:varchar(20);default:'user'\" json:\"role\"` — values: 'user', 'admin'\n\nModify file: backend/internal/middleware/auth.go\n- Verify AdminRequired middleware exists and correctly checks user role from DB:\n  func AdminRequired(db *gorm.DB) fiber.Handler that:\n  1. Extracts userID from JWT claims (same as JWTProtected)\n  2. Queries User from DB: var user models.User; db.First(\u0026user, \"id = ?\", userID)\n  3. Checks user.Role == \"admin\"\n  4. If not admin, returns 403 Forbidden: {\"error\": true, \"message\": \"Admin access required\"}\n  5. Calls c.Next() if admin\n\nModify file: backend/internal/services/auth_service.go\n- In Register method, ensure new users get Role: \"user\" by default (GORM default handles this)\n- In the JWT token generation, include role in claims: claims[\"role\"] = user.Role\n\nModify file: backend/internal/dto/auth_dto.go\n- Add Role string `json:\"role\"` to LoginResponse and any user-facing response DTOs\n\nModify file: backend/internal/handlers/auth_handler.go\n- Include role in login/register response so mobile app can display admin badge if needed\n\nThis fixes the documented security gap where any authenticated user could access admin moderation endpoints.",
      "status": "pending",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_013",
      "title": "Add analysis loading animation with streaming-style progress to alerts screen",
      "description": "When analysis runs (alerts.tsx line 97-118), only a small ActivityIndicator replaces the Analyze button text. For an AI-powered app, the analysis loading experience should feel intelligent with streaming-style progress feedback matching 2025-2026 AI interface trends.\n\nModify file: mobile/app/(protected)/alerts.tsx\n- Add new state: const [analysisProgress, setAnalysisProgress] = useState\u003cstring[]\u003e([])\n- In handleAnalyze, before the API call, simulate AI processing steps with timed messages:\n  setAnalysisProgress(['Connecting to satellite data...'])\n  setTimeout(() =\u003e setAnalysisProgress(prev =\u003e [...prev, 'Analyzing land use patterns...']), 800)\n  setTimeout(() =\u003e setAnalysisProgress(prev =\u003e [...prev, 'Detecting environmental changes...']), 1600)\n  setTimeout(() =\u003e setAnalysisProgress(prev =\u003e [...prev, 'Calculating confidence scores...']), 2400)\n- After API response, add final message and clear after delay:\n  setAnalysisProgress(prev =\u003e [...prev, 'Analysis complete!'])\n  setTimeout(() =\u003e setAnalysisProgress([]), 1000)\n\n- When analysisProgress.length \u003e 0, render a modal overlay above the FlatList:\n  \u003cView className=\"absolute inset-0 bg-black/70 z-50 justify-center items-center px-8\"\u003e\n    \u003cView className=\"bg-gray-900 rounded-2xl p-6 w-full border border-gray-800\"\u003e\n      \u003cView className=\"items-center mb-4\"\u003e\n        \u003cActivityIndicator size=\"large\" color=\"#10b981\" /\u003e\n        \u003cText className=\"text-lg font-bold text-white mt-3\"\u003eAI Analysis Running\u003c/Text\u003e\n      \u003c/View\u003e\n      {analysisProgress.map((step, i) =\u003e (\n        \u003cView key={i} className=\"flex-row items-center mb-2\"\u003e\n          \u003cIonicons name={i === analysisProgress.length - 1 ? 'ellipsis-horizontal' : 'checkmark-circle'} size={16} color={i === analysisProgress.length - 1 ? '#f59e0b' : '#10b981'} /\u003e\n          \u003cText className=\"text-sm text-gray-300 ml-2\" style={i === analysisProgress.length - 1 ? { color: '#f59e0b' } : {}}\u003e{step}\u003c/Text\u003e\n        \u003c/View\u003e\n      ))}\n    \u003c/View\u003e\n  \u003c/View\u003e\n\n- Clear progress on error: in catch block add setAnalysisProgress([])\n- This creates a perceived intelligence for the AI analysis process, reducing user anxiety during the API call wait time.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    }
  ]
}