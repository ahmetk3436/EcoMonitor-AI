{
  "tasks": [
    {
      "id": "enhance_001",
      "title": "Replace dummy satellite analysis with real AI-powered detection",
      "description": "CRITICAL MOCK REMOVAL: backend/internal/services/satellite_service.go GenerateDummyAnalysis() generates FAKE satellite data with random change types, random confidence scores (0.5-1.0), random dates, and a placeholder image URL 'https://example.com/satellite-image-placeholder.jpg'. This MUST be replaced with real satellite imagery analysis.\n\nFiles to modify:\n- backend/internal/services/satellite_service.go: Replace GenerateDummyAnalysis() with GenerateAnalysis() that calls a real API. Add OpenAI GPT-4o-mini integration for analyzing satellite imagery from a free source. Add new fields: OPENAI_API_KEY and SATELLITE_API_KEY to config.\n- backend/internal/config/config.go: Add OpenAIAPIKey string field, load from OPENAI_API_KEY env var. Add SatelliteAPIURL string field defaulting to 'https://api.openai.com/v1/chat/completions'.\n- backend/internal/handlers/satellite_handler.go: Update GenerateAnalysis handler to call the renamed service method.\n\nImplementation:\n1. In satellite_service.go, add a struct openAIRequest/openAIResponse for the chat completion API.\n2. GenerateAnalysis() should: (a) Fetch the coordinate from DB, (b) Build a prompt: 'Analyze satellite environmental conditions at latitude {lat}, longitude {lng}. Identify any of these change types: construction, vegetation_loss, water_change, urban_expansion. For each detected change, provide: changeType, confidence (0.0-1.0), and a detailed summary. Respond in JSON array format.' (c) Call OpenAI API with model 'gpt-4o-mini', temperature 0.3, (d) Parse the JSON response into []SatelliteData records, (e) Save to DB with real timestamps, (f) Use a real satellite tile URL: fmt.Sprintf('https://mt1.google.com/vt/lyrs=s&x=0&y=0&z=1') as placeholder image until a real imagery API is integrated.\n3. Add http.Client with 30s timeout for external API calls.\n4. Add error handling: if OpenAI fails, return a user-friendly error, do NOT fall back to dummy data.\n5. Keep the existing GetAnalysisForCoordinate() and GetLatestAlerts() methods unchanged - they read from DB and work correctly.",
      "status": "pending",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend && go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:40Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_002",
      "title": "Add environment analysis history model and backend endpoints",
      "description": "The app lacks a persistent history system for tracking past analyses per user. Users need to see their analysis history over time, not just the latest alerts.\n\nFiles to modify:\n- backend/internal/models/analysis_history.go (NEW): Create AnalysisHistory model with fields: ID (UUID, primary key), UserID (UUID, foreign key to User, indexed), CoordinateID (UUID, foreign key to Coordinate), AnalysisType string (satellite, vegetation, water), ResultSummary string (varchar 2000), ConfidenceAvg float64, ChangeCount int, CreatedAt time.Time. Add TableName() returning 'analysis_histories'.\n- backend/internal/database/database.go: Add models.AnalysisHistory to the AutoMigrate call after SatelliteData.\n- backend/internal/dto/history_dto.go (NEW): Create HistoryResponse struct {ID, CoordinateLabel, AnalysisType, ResultSummary, ConfidenceAvg, ChangeCount, CreatedAt}. Create PaginatedHistoryResponse {Data []HistoryResponse, Page, Limit, TotalCount, TotalPages int}.\n- backend/internal/services/history_service.go (NEW): Create HistoryService with db field. Methods: (a) RecordAnalysis(userID, coordinateID UUID, analysisType string, results []SatelliteDataResponse) - creates AnalysisHistory record computing avg confidence and change count from results, (b) GetUserHistory(userID UUID, page, limit int) returns PaginatedHistoryResponse joining with coordinates for label, ordered by created_at DESC.\n- backend/internal/handlers/history_handler.go (NEW): Create HistoryHandler. Method GetHistory() reads page/limit from query params (defaults: page=1, limit=20, max 50), calls service, returns JSON.\n- backend/internal/routes/routes.go: Add GET /api/history to protected group, wire historyHandler.GetHistory.\n- backend/cmd/server/main.go: Instantiate HistoryService and HistoryHandler, pass to RegisterRoutes.\n- backend/internal/services/satellite_service.go: After saving satellite data in GenerateAnalysis, call historyService.RecordAnalysis() to persist the history entry. Add historyService field to SatelliteService struct.",
      "status": "pending",
      "priority": 10,
      "depends_on": [
        "enhance_001"
      ],
      "test_command": "cd backend && go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_003",
      "title": "Build 3-screen onboarding flow with feature showcase",
      "description": "The app has NO onboarding - users go directly to login. Must add a 3-screen onboarding flow that introduces the app before auth.\n\nFiles to create/modify:\n- mobile/app/onboarding.tsx (NEW): Create a horizontal ScrollView (pagingEnabled, showsHorizontalScrollIndicator={false}) with 3 screens. Use useState for activeIndex, update via onMomentumScrollEnd calculating page from contentOffset.x / width.\n\nScreen 1 (Welcome): View className='flex-1 items-center justify-center px-8 bg-white'. Ionicons 'earth' size={120} color='#2563eb'. Text className='text-3xl font-bold text-gray-900 mt-8 text-center' content='EcoMonitor AI'. Text className='text-base text-gray-500 mt-4 text-center' content='Monitor environmental changes from space with AI-powered satellite analysis'.\n\nScreen 2 (Features): Same container. Ionicons 'satellite-outline' size={100} color='#2563eb'. Text 'Real-Time Detection' as title. Four feature rows, each a View className='flex-row items-center mt-4 px-4': Ionicons icon (leaf/water/business/hammer) size=24 color='#3b82f6', Text className='text-base text-gray-700 ml-3' with feature names: 'Vegetation loss tracking', 'Water body monitoring', 'Urban expansion alerts', 'Construction detection'.\n\nScreen 3 (CTA): Ionicons 'shield-checkmark' size={100} color='#16a34a'. Text 'Start Monitoring'. Two buttons: (a) Pressable className='w-full bg-primary-600 rounded-2xl py-4 mt-8' text='Try Free' navigating to /(auth)/register, (b) Pressable className='w-full border border-gray-300 rounded-2xl py-4 mt-4' text='Sign In' navigating to /(auth)/login. Both call hapticLight().\n\nPage dots: View className='flex-row justify-center mb-12'. Three dots using View className={cn('w-2.5 h-2.5 rounded-full mx-1.5', i === activeIndex ? 'bg-primary-600' : 'bg-gray-300')}.\n\nStore onboarding completion: AsyncStorage.setItem('onboarding_complete', 'true') when user taps either CTA button.\n\n- mobile/app/index.tsx: Before checking auth, check AsyncStorage.getItem('onboarding_complete'). If null, Redirect to /onboarding. Import AsyncStorage from @react-native-async-storage/async-storage. Note: Since AsyncStorage is not in package.json, use expo-secure-store's setItemAsync/getItemAsync as a workaround with key 'onboarding_complete'.",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:46Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_004",
      "title": "Implement guest mode with 3 free analyses counter",
      "description": "Apple Guideline 5.1.1v requires the app to work without login. Currently, unauthenticated users are hard-redirected to login with no option to explore the app.\n\nFiles to modify:\n- mobile/contexts/AuthContext.tsx: Add isGuest boolean to AuthState and context value. Add enterGuestMode() function that sets isGuest=true without tokens. Add guestAnalysesUsed number state (loaded from SecureStore key 'guest_analyses_count' on mount). Add incrementGuestAnalysis() that increments the counter and saves to SecureStore. Add canUseGuestAnalysis computed: guestAnalysesUsed < 3. Export all new values via context.\n\n- mobile/app/index.tsx: Update redirect logic: if onboarding not complete \u2192 /onboarding, else if isAuthenticated \u2192 /(protected)/home, else if isGuest \u2192 /(protected)/home, else \u2192 /(auth)/login.\n\n- mobile/app/(auth)/login.tsx: Add a 'Skip for now' Pressable below the Sign In button. Text className='text-primary-600 text-base font-medium text-center mt-6'. On press: call enterGuestMode() from useAuth(), then router.replace('/(protected)/home'). Add hapticLight() on press.\n\n- mobile/app/(protected)/_layout.tsx: Update auth guard to allow guest mode. Change condition from 'if (!isAuthenticated)' to 'if (!isAuthenticated && !isGuest)'. Import isGuest from useAuth().\n\n- mobile/app/(protected)/alerts.tsx: In handleAnalyze, before the subscription check, add a guest check: if (isGuest && !canUseGuestAnalysis) show Alert.alert('Free Limit Reached', 'Create an account to continue analyzing locations', [{text: 'Sign Up', onPress: () => router.push('/(auth)/register')}, {text: 'Cancel'}]); return. If isGuest && canUseGuestAnalysis, call incrementGuestAnalysis() after successful analysis.\n\n- mobile/app/(protected)/home.tsx: If isGuest, show a banner at top: View className='mx-4 mb-4 bg-primary-50 rounded-2xl p-4 flex-row items-center'. Ionicons 'information-circle' size=24 color='#2563eb'. Text '3 free analyses remaining' (or dynamic count). Pressable 'Create Account' text in primary-600 color linking to /(auth)/register.",
      "status": "pending",
      "priority": 8,
      "depends_on": [
        "enhance_003"
      ],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_005",
      "title": "Redesign home screen as environmental monitoring dashboard",
      "description": "PLACEHOLDER REMOVAL: home.tsx currently shows generic template text 'Your MVP starts here. This is the Phase 0 Master Template.' and just a sign-out button. Must be replaced with a real EcoMonitor dashboard.\n\nFile to modify: mobile/app/(protected)/home.tsx\n\nComplete rewrite:\n- Imports: React, useState, useCallback, View, Text, ScrollView, Pressable, ActivityIndicator, RefreshControl from react-native. Ionicons. useFocusEffect, router from expo-router. api from lib/api. useAuth from contexts/AuthContext. hapticLight, hapticSelection from lib/haptics. SafeAreaView from react-native-safe-area-context.\n\n- State: alerts (SatelliteAlert[]), coordinates (Coordinate[]), loading (bool), refreshing (bool).\n\n- useFocusEffect: fetch /satellite/alerts?limit=5 and /coordinates?limit=5 in parallel using Promise.all.\n\n- JSX Structure:\n1. SafeAreaView className='flex-1 bg-gray-50'. ScrollView with RefreshControl.\n2. Header: View className='px-6 pt-6 pb-4'. Text className='text-3xl font-bold text-gray-900' 'EcoMonitor AI'. Text className='text-base text-gray-500 mt-1' 'Environmental Intelligence Dashboard'.\n3. Stats Row: View className='flex-row px-4 mb-6'. Three stat cards, each View className='flex-1 mx-2 bg-white rounded-2xl p-4 items-center' with shadow via style={{shadowColor:'#000',shadowOffset:{width:0,height:2},shadowOpacity:0.08,shadowRadius:8,elevation:3}}. Card 1: Ionicons 'location' size=28 color='#2563eb', Text coordinates.length, Text 'Locations'. Card 2: Ionicons 'notifications' size=28 color='#f97316', Text alerts.length, Text 'Alerts'. Card 3: Ionicons 'analytics' size=28 color='#16a34a', Text showing high-confidence count (alerts.filter(a => a.confidence > 0.8).length), Text 'Critical'.\n4. Recent Alerts section: View className='px-6 mb-4'. Header row with Text 'Recent Alerts' font-bold and Pressable 'View All' text-primary-600 routing to alerts tab. If alerts empty: View with Ionicons 'checkmark-circle' size=48 color='#16a34a' and text 'No alerts - all clear'. If alerts exist: map first 3, each in Pressable className='bg-white rounded-2xl p-4 mb-3' with shadow. Show change type icon, label, confidence badge (color-coded), and date.\n5. Your Locations section: Similar header with 'View All' routing to map tab. Show first 3 coordinates in horizontal ScrollView (horizontal, showsHorizontalScrollIndicator={false}). Each location card: Pressable className='bg-white rounded-2xl p-4 mr-3 w-40' with Ionicons 'location-outline', label text, and lat/lng in small gray text.\n6. Quick Actions: View className='px-6 mb-8'. Two Pressable buttons side by side: 'Add Location' (map icon, routes to map tab) and 'View Alerts' (notifications icon, routes to alerts tab). Each className='flex-1 mx-2 bg-primary-600 rounded-2xl py-4 items-center' with white text.",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:49Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_006",
      "title": "Add analysis history screen with persistent results",
      "description": "Users have no way to review past analyses. Need a dedicated history screen showing all previous satellite analyses with details.\n\nFiles to create/modify:\n- mobile/types/history.ts (NEW): Export interface AnalysisHistory { id: string; coordinateLabel: string; analysisType: string; resultSummary: string; confidenceAvg: number; changeCount: number; createdAt: string; }. Export interface PaginatedHistory { data: AnalysisHistory[]; page: number; limit: number; totalCount: number; totalPages: number; }.\n\n- mobile/app/(protected)/history.tsx (NEW): Full screen implementation.\nImports: React, useState, useCallback, View, Text, FlatList, RefreshControl, ActivityIndicator, Pressable from react-native. Ionicons. useFocusEffect from expo-router. api from lib/api. SafeAreaView from react-native-safe-area-context. hapticSelection from lib/haptics.\n\nState: history (AnalysisHistory[]), page (1), loading (bool), refreshing (bool), hasMore (bool).\n\nFetch function: GET /history?page={page}&limit=20. On success, append to history if page > 1, replace if page === 1. Set hasMore based on totalPages.\n\nRender item: Pressable className='bg-white rounded-2xl p-4 mb-3 mx-4' with shadow. Top row: Ionicons 'time-outline' size=20 color='#6b7280', Text with formatted date (toLocaleDateString). Middle: Text className='text-lg font-semibold text-gray-900 mt-2' showing coordinateLabel. Text className='text-sm text-gray-500 mt-1' showing analysisType capitalized. Bottom row: View className='flex-row mt-3 items-center'. Confidence badge: View className='bg-primary-50 rounded-full px-3 py-1', Text showing confidenceAvg as percentage. Changes count: Text '{changeCount} changes detected' in gray-600.\n\nEmpty state: View centered with Ionicons 'file-tray-outline' size=64 color='#9ca3af'. Text 'No analysis history yet'. Text 'Analyze a location to see results here' in gray-400.\n\nPagination: onEndReached={() => { if (hasMore && !loading) { setPage(p => p + 1); } }}. onEndReachedThreshold={0.5}.\n\n- mobile/app/(protected)/_layout.tsx: Add new tab for history between alerts and settings. Tab name 'history', icon 'time-outline', title 'History'. Order: home, map, alerts, history, settings. Keep paywall as href:null.",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_002"
      ],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_007",
      "title": "Add coordinate update endpoint and detail screen",
      "description": "Backend has no update coordinate endpoint, and the mobile app has no way to view detailed info about a monitored location or edit it.\n\nFiles to modify:\n- backend/internal/services/coordinate_service.go: Add UpdateCoordinate(id, userID UUID, req *UpdateCoordinateRequest) method. Ownership check (where id = ? AND user_id = ?). If req.Latitude != nil, validate range and update. Same for Longitude, Label, Description. Use map[string]interface{} for partial updates via db.Model(&Coordinate{}).Where(...).Updates(updates). Return ErrCoordinateNotFound if 0 rows affected. Return updated CoordinateResponse.\n- backend/internal/handlers/coordinate_handler.go: Add UpdateCoordinate() handler. Parse UUID from params, parse UpdateCoordinateRequest body, extract userID from JWT, call service. Return 200 + CoordinateResponse or 404.\n- backend/internal/routes/routes.go: Add PUT /api/coordinates/:id to protected group, wire coordinateHandler.UpdateCoordinate.\n\n- mobile/app/(protected)/coordinate-detail.tsx (NEW): Screen for viewing/editing a single coordinate. Use expo-router's useLocalSearchParams() to get {id} param.\nImports: React, useState, useEffect, View, Text, ScrollView, TextInput, Pressable, ActivityIndicator, Alert from react-native. Ionicons. router, useLocalSearchParams. api. SafeAreaView. hapticSuccess, hapticError.\n\nOn mount: GET /coordinates/{id} to load coordinate data.\n\nJSX: SafeAreaView bg-gray-50. Header with back button (router.back()) and title 'Location Details'. Map preview: small MapView (height 200, rounded-2xl, pointerEvents='none') showing the coordinate as a marker. Below: Editable fields for label and description in View className='bg-white rounded-2xl p-6 mx-4 mt-4' with shadow. TextInput for label (className='text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2 mb-4'). TextInput for description (multiline, className='text-base text-gray-600'). Lat/Lng display (non-editable) in gray text. Save button: Pressable className='bg-primary-600 rounded-2xl py-4 mx-4 mt-4 items-center'. On save: PUT /coordinates/{id} with updated label and description.\n\nAdd 'Analyze This Location' button below: Pressable className='bg-green-600 rounded-2xl py-4 mx-4 mt-3 items-center'. On press: POST /coordinates/{id}/analyze then navigate to alerts tab.\n\n- mobile/app/(protected)/_layout.tsx: Add coordinate-detail as a hidden screen (href: null) in the tab navigator so it can be navigated to programmatically.\n- mobile/app/(protected)/map.tsx: When a marker is tapped and selectedCoordinate is shown, add a 'Details' button that navigates to coordinate-detail with the coordinate id.",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd backend && go build ./... && cd ../mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:52Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_008",
      "title": "Add share functionality for satellite alert results",
      "description": "Users cannot share environmental alerts they discover. Need shareable result cards with gradient backgrounds.\n\nFiles to create/modify:\n- mobile/lib/share.ts (NEW): Import { Share, Platform } from 'react-native'. Export async function shareAlert(alert: SatelliteAlert): Promise<void>. Build share message: 'EcoMonitor AI Alert\\n\\nChange Type: {changeType}\\nConfidence: {confidence}%\\nLocation: {coordinates.label} ({lat}, {lng})\\nDetected: {date}\\n\\n{summary}\\n\\nMonitor environmental changes with EcoMonitor AI'. Call Share.share({ message, title: 'EcoMonitor AI - Environmental Alert' }). Wrap in try/catch, ignore user dismissal errors.\n\nExport async function shareAnalysisSummary(locationLabel: string, changeCount: number, avgConfidence: number): Promise<void>. Message: 'I just analyzed {locationLabel} with EcoMonitor AI!\\n\\n{changeCount} environmental changes detected (avg confidence: {avgConfidence}%).\\n\\nTrack environmental changes from space with EcoMonitor AI'. Call Share.share().\n\n- mobile/app/(protected)/alerts.tsx: Add share button to each alert card. In renderAlertItem, after the Analyze button, add: View className='flex-row mt-3'. Pressable className='flex-1 flex-row items-center justify-center bg-gray-100 rounded-xl py-2.5'. Ionicons 'share-outline' size=18 color='#4b5563'. Text className='text-gray-700 font-medium ml-2' 'Share'. On press: import shareAlert from lib/share, call shareAlert(item), hapticLight().\n\n- mobile/app/(protected)/home.tsx: Add share button on each alert card in the recent alerts section. Same pattern as alerts screen but smaller (py-2 rounded-lg).\n\n- After every successful satellite analysis (in alerts.tsx handleAnalyze after hapticSuccess and fetchAlerts), show a prompt: Alert.alert('Analysis Complete', 'Share your findings?', [{text: 'Share', onPress: () => shareAnalysisSummary(...)}, {text: 'Later', style: 'cancel'}]).",
      "status": "pending",
      "priority": 6,
      "depends_on": [
        "enhance_005"
      ],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_009",
      "title": "Implement daily monitoring streak system with rewards",
      "description": "Add a gamification system to encourage daily app usage and environmental monitoring.\n\nFiles to create/modify:\n- mobile/lib/streak.ts (NEW): Import * as SecureStore from 'expo-secure-store'. Define STREAK_LAST_DATE_KEY = 'eco_streak_last_date' and STREAK_COUNT_KEY = 'eco_streak_count'.\n\nExport interface StreakData { currentStreak: number; lastCheckDate: string | null; }.\n\nExport async function getStreak(): Promise<StreakData>. Read both keys from SecureStore. Parse count as int (default 0). Return { currentStreak: count, lastCheckDate }.\n\nExport async function recordDailyCheck(): Promise<StreakData>. Get today as YYYY-MM-DD string. Read lastDate from SecureStore. If lastDate === today, return current streak (already checked today). If lastDate === yesterday (compare Date objects), increment streak count. Else reset streak to 1. Save new count and today's date to SecureStore. Return updated StreakData.\n\nExport function getStreakEmoji(streak: number): string. Return: streak >= 30 ? 'fire' : streak >= 14 ? 'star' : streak >= 7 ? 'trophy' : streak >= 3 ? 'flame' : 'leaf'. (These are Ionicons names.)\n\nExport function getStreakMessage(streak: number): string. streak >= 30: 'Legendary Eco Guardian!', >= 14: 'Dedicated Monitor!', >= 7: 'Rising Protector!', >= 3: 'Getting Started!', default: 'Start your streak!'.\n\n- mobile/app/(protected)/home.tsx: Add streak display to dashboard. Import getStreak, recordDailyCheck, getStreakEmoji, getStreakMessage from lib/streak. Add streakData state. On focus effect, call recordDailyCheck() to mark today's activity, store result in streakData. Display streak card above stats row: View className='mx-4 mb-4 bg-white rounded-2xl p-4 flex-row items-center justify-between' with shadow. Left side: Ionicons name={getStreakEmoji(streakData.currentStreak)} size=32 color='#f97316'. View with Text className='text-2xl font-bold text-gray-900' showing streak count + ' days'. Text className='text-sm text-gray-500' showing getStreakMessage(). Right side: View className='bg-orange-50 rounded-full px-3 py-1'. Text className='text-orange-600 font-semibold text-xs' showing 'STREAK' badge.",
      "status": "pending",
      "priority": 6,
      "depends_on": [
        "enhance_005"
      ],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_010",
      "title": "Polish alerts screen with enhanced UI, error states, and empty state",
      "description": "The alerts screen lacks proper error handling UI, has no header/title, and the empty state is minimal. Needs App Store quality polish.\n\nFile to modify: mobile/app/(protected)/alerts.tsx\n\nChanges:\n1. Add SafeAreaView wrapper: Import SafeAreaView from react-native-safe-area-context. Wrap entire return in SafeAreaView className='flex-1 bg-gray-50'.\n\n2. Add screen header: Before FlatList, add View className='px-6 pt-6 pb-4 bg-white border-b border-gray-100'. Text className='text-3xl font-bold text-gray-900' content 'Alerts'. Text className='text-sm text-gray-500 mt-1' content 'Environmental change detection'.\n\n3. Add error state: New state: error (string | null). In fetchAlerts catch block, set error message. If error is truthy, render: View className='flex-1 justify-center items-center px-8'. Ionicons 'cloud-offline-outline' size=64 color='#ef4444'. Text className='text-lg font-semibold text-gray-900 mt-4' 'Failed to load alerts'. Text className='text-sm text-gray-500 mt-2 text-center' showing error message. Pressable className='bg-primary-600 rounded-2xl px-8 py-3 mt-6' onPress={() => { setError(null); setLoading(true); fetchAlerts(); }}. Text 'Retry' in white font-semibold. Call hapticError() when error occurs.\n\n4. Enhance empty state: Replace current minimal empty state with: View className='flex-1 justify-center items-center px-8 mt-20'. Ionicons 'earth-outline' size=80 color='#d1d5db'. Text className='text-xl font-semibold text-gray-900 mt-6' 'No Alerts Yet'. Text className='text-base text-gray-500 mt-2 text-center' 'Add locations on the map and run satellite analysis to receive environmental change alerts'. Pressable className='bg-primary-600 rounded-2xl px-8 py-3 mt-6 flex-row items-center' onPress={() => router.push('/(protected)/map')}. Ionicons 'map-outline' size=20 color='white'. Text 'Go to Map' white font-semibold ml-2.\n\n5. Enhance alert cards: Add shadow to each card via style={{shadowColor:'#000',shadowOffset:{width:0,height:1},shadowOpacity:0.05,shadowRadius:4,elevation:2}}. Capitalize change type display: item.changeType.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase()). Add border-l-4 color based on change type: construction='border-l-amber-500', vegetation_loss='border-l-red-500', water_change='border-l-blue-500', urban_expansion='border-l-purple-500'.\n\n6. Fix confidence display: Currently shows raw decimal (0.85) but the getConfidenceColor function checks > 80. Multiply by 100 for display: Math.round(item.confidence * 100). Update getConfidenceColor to handle 0-1 range: if (confidence > 0.8) red, if (confidence > 0.5) orange, else green.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:35:02Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_011",
      "title": "Polish settings screen with profile section and privacy policy",
      "description": "Settings screen needs a profile section header, privacy policy link (Apple requirement), app version display, and visual improvements.\n\nFile to modify: mobile/app/(protected)/settings.tsx\n\nChanges:\n1. Add profile header: At top of ScrollView content, add View className='items-center pt-8 pb-6'. View className='w-20 h-20 rounded-full bg-primary-100 items-center justify-center mb-3'. Ionicons 'person' size=40 color='#2563eb'. Text className='text-xl font-bold text-gray-900' showing user email (or 'Guest' if isGuest). If isGuest: Pressable className='bg-primary-600 rounded-full px-6 py-2 mt-2'. Text 'Create Account' white font-medium. Route to /(auth)/register.\n\n2. Add section dividers: Each section gets a header View className='px-6 pt-6 pb-2'. Text className='text-xs font-semibold text-gray-400 uppercase tracking-wider' with section title.\n\n3. Restyle setting items: Each item in a View className='bg-white mx-4 rounded-2xl mb-3' with shadow. Each row: Pressable className='flex-row items-center justify-between px-4 py-4'. Left: View flex-row items-center with Ionicons icon and Text. Right: Ionicons 'chevron-forward' size=20 color='#9ca3af' (or Switch for biometrics toggle).\n\n4. Add Privacy Policy section: New section 'LEGAL' with two items. (a) 'Privacy Policy' with Ionicons 'document-text-outline' - onPress opens Linking.openURL('https://ecomonitor-ai.com/privacy') (or Alert.alert explaining privacy policy placeholder). (b) 'Terms of Service' with Ionicons 'reader-outline' - same pattern.\n\n5. Add App Info section: View className='items-center py-8'. Text className='text-sm text-gray-400' showing 'EcoMonitor AI v1.0.0'. Text className='text-xs text-gray-300 mt-1' showing 'Made with care for the planet'.\n\n6. Import Linking from react-native. Import { hapticLight, hapticSelection } from lib/haptics. Add hapticSelection() on every setting item press. Add hapticLight() on toggle changes.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:35:05Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_012",
      "title": "Add admin role middleware and environment indicator endpoint",
      "description": "Backend has admin routes with TODO comment 'add admin role middleware here' - they are unprotected. Also need an environment info endpoint for the mobile app to detect staging vs production.\n\nFiles to modify:\n- backend/internal/models/user.go: Add Role string field with gorm tag 'type:varchar(20);default:user;not null'. Valid values: 'user', 'admin'. Add json tag 'role'.\n\n- backend/internal/middleware/admin.go (NEW): Create AdminRequired() fiber.Handler middleware. Extract JWT claims from c.Locals('user'). Parse 'sub' claim to get userID. Query db for user by ID. If user.Role != 'admin', return 403 + ErrorResponse{Error: true, Message: 'admin access required'}. Call c.Next() if admin. The middleware takes *gorm.DB as parameter.\n\n- backend/internal/routes/routes.go: Apply AdminRequired middleware to the admin group. Import the new middleware. Change admin group from just jwt.JWTProtected to using both: admin := api.Group('/admin', middleware.JWTProtected(cfg), middleware.AdminRequired(db)).\n\n- backend/internal/handlers/health_handler.go: Add GetEnvironment() handler that returns {environment: os.Getenv('APP_ENV') or 'development', version: '1.0.0', features: {satellite_analysis: true, guest_mode: true, streak_system: true}}. Register at GET /api/env (public endpoint).\n\n- backend/internal/routes/routes.go: Add GET /api/env route pointing to healthHandler.GetEnvironment.\n\n- backend/internal/dto/auth_dto.go: Add Role field to UserResponse struct: Role string `json:\"role\"`. Update all places where UserResponse is constructed to include user.Role.\n\n- backend/internal/services/auth_service.go: In Register(), set user.Role = 'user' explicitly. In the UserResponse construction within generateTokenPair, add Role: user.Role.",
      "status": "pending",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd backend && go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:43Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_013",
      "title": "Add coordinate search and filtering to map screen",
      "description": "The map screen has no search functionality - users with many pins cannot find specific locations. Need a search bar and change-type filter.\n\nFiles to modify:\n- backend/internal/services/coordinate_service.go: Add search parameter to ListCoordinates. New signature: ListCoordinates(userID UUID, page, limit int, search string). If search is non-empty, add WHERE clause: (LOWER(label) LIKE LOWER('%search%') OR LOWER(description) LIKE LOWER('%search%')). Use db.Where('user_id = ? AND (LOWER(label) LIKE ? OR LOWER(description) LIKE ?)', userID, '%'+strings.ToLower(search)+'%', '%'+strings.ToLower(search)+'%').\n\n- backend/internal/handlers/coordinate_handler.go: In ListCoordinates handler, read 'search' query param: search := c.Query('search', ''). Pass to service.\n\n- mobile/app/(protected)/map.tsx: Add search bar overlay on top of map. At top of the View container (after MapView), add an absolute-positioned search bar: View style={{position:'absolute',top:60,left:16,right:16,zIndex:10}}. View className='bg-white rounded-2xl flex-row items-center px-4 py-3' with shadow (shadowColor '#000', shadowOpacity 0.1, shadowRadius 8, elevation 4). Ionicons 'search-outline' size=20 color='#9ca3af'. TextInput className='flex-1 ml-3 text-base text-gray-900' placeholder='Search locations...' value={searchQuery} onChangeText={setSearchQuery}. If searchQuery non-empty, show clear button: Pressable onPress={() => setSearchQuery('')}. Ionicons 'close-circle' size=20 color='#9ca3af'.\n\nAdd searchQuery state. Add useEffect that debounces search (300ms timeout) and calls loadCoordinates with search param. Update loadCoordinates to accept optional search string and pass as query param: api.get('/coordinates', { params: { search: searchQuery } }).\n\nWhen search results change, if exactly 1 result, animate map to that coordinate using mapRef.current?.animateToRegion().",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd backend && go build ./... && cd ../mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:55Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_014",
      "title": "Add register auto-login and improve auth error handling",
      "description": "The register flow currently does auto-login (register() in AuthContext saves tokens), but error messages are generic. Login screen needs better UX with specific error messages and input validation.\n\nFiles to modify:\n- mobile/app/(auth)/login.tsx: Add client-side validation before API call. Check email format with regex /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/. Check password is non-empty. Show specific error messages: 'Please enter a valid email address', 'Password is required'. Add hapticError() on validation failure. Style the error box: View className='bg-red-50 border border-red-200 rounded-2xl p-4 mb-4 flex-row items-start'. Ionicons 'alert-circle' size=20 color='#dc2626'. Text className='text-red-700 text-sm ml-2 flex-1'. Add 'Forgot Password?' Pressable below password field (for now, Alert.alert explaining password reset is not yet available). Text className='text-primary-600 text-sm font-medium text-right mt-1'.\n\n- mobile/app/(auth)/register.tsx: Improve validation UX. Add real-time password strength indicator below password field: View className='mt-2'. Calculate strength: length >= 12 && hasUppercase && hasNumber && hasSpecial = 'Strong' (green), length >= 8 && (hasUppercase || hasNumber) = 'Medium' (yellow), length >= 8 = 'Weak' (red). Show as: View className='flex-row items-center'. Three View dots (w-8 h-1.5 rounded-full mr-1) colored based on strength. Text className='text-xs ml-2' showing strength label. Add hapticSuccess() after successful registration. Improve error messages: catch error from register(), check if error.response?.data?.message contains 'email already registered' and show 'This email is already registered. Try signing in instead.' with a Pressable 'Sign In' link.\n\n- mobile/contexts/AuthContext.tsx: In the register function, after successful registration and token save, add hapticSuccess() call (if not already present). Ensure the user state is set immediately after register so isAuthenticated becomes true and index.tsx redirects to home.",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:34:58Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    },
    {
      "id": "enhance_015",
      "title": "Add loading skeletons and pull-to-refresh across all screens",
      "description": "Several screens use plain ActivityIndicator spinners. Need skeleton loading placeholders and consistent pull-to-refresh for App Store quality.\n\nFiles to modify:\n- mobile/components/ui/Skeleton.tsx (NEW): Create a skeleton loading component. Import React, useEffect, useRef, View, Animated from react-native. Props: width (number|string), height (number), borderRadius (number, default 8), className (string). Use Animated.Value for opacity pulse animation: Animated.loop(Animated.sequence([Animated.timing(opacity, {toValue: 0.3, duration: 800, useNativeDriver: true}), Animated.timing(opacity, {toValue: 1, duration: 800, useNativeDriver: true})])). Return Animated.View with style={{opacity, width, height, borderRadius, backgroundColor: '#e5e7eb'}} and className.\n\n- mobile/app/(protected)/home.tsx: Replace ActivityIndicator loading state with skeleton dashboard. Show: skeleton header (Skeleton width='60%' height={32}), skeleton stats row (3x Skeleton className='flex-1 mx-2' height={100} borderRadius={16}), skeleton alert cards (3x View with Skeleton width='100%' height={80} borderRadius={16} className='mb-3 mx-4').\n\n- mobile/app/(protected)/alerts.tsx: Replace ActivityIndicator with skeleton alert cards. Show 4 skeleton cards: each View className='mx-4 mb-3', Skeleton width='100%' height={160} borderRadius={16}.\n\n- mobile/app/(protected)/map.tsx: Keep the ActivityIndicator for map (maps need full render) but add a text below: Text className='text-gray-500 mt-4 text-base' 'Loading your map...'.\n\n- mobile/app/(protected)/settings.tsx: Add RefreshControl to the ScrollView. State: refreshing. On refresh: re-check biometric availability and subscription status. Import RefreshControl from react-native. ScrollView refreshControl={<RefreshControl refreshing={refreshing} onRefresh={handleRefresh} colors={['#2563eb']} tintColor='#2563eb' />}.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile && npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-07T14:35:08Z",
      "error": "planning failed: engine: all 1 providers failed:\n  provider GLM-Planner (glm-4.7): failed after 2 retries: API returned 429: {\"error\":{\"code\":\"1302\",\"message\":\"Rate limit reached for requests\"}}"
    }
  ]
}